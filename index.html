<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Snake Game with Futuristic Menu and Music Toggle</title>
<style>
  body {
    margin: 0;
    height: 100vh;
    font-family: 'Arial', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* Main menu styles - futuristic bluish */
  #menu {
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    backdrop-filter: blur(15px);
    border-radius: 20px;
    padding: 40px 60px;
    box-shadow: 0 0 40px rgba(0, 191, 255, 0.6);
    text-align: center;
    color: #fff;
    width: 80%;
    max-width: 400px;
  }

  #menu h1 {
    font-family: 'Orbitron', Arial, sans-serif;
    font-size: 2.5em;
    margin-bottom: 20px;
    letter-spacing: 2px;
    color: #00ffff;
  }

  /* Map selection buttons styling */
  .map-button {
    display: block;
    width: 100%;
    padding: 15px;
    margin: 10px 0;
    font-size: 1.2em;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    background: linear-gradient(135deg, #00ffff, #007fff);
    color: #fff;
    transition: all 0.3s ease;
    box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
  }

  .map-button:hover {
    background: linear-gradient(135deg, #007fff, #00ffff);
    box-shadow: 0 0 25px rgba(0, 255, 255, 0.8);
    transform: translateY(-3px);
  }

  /* Welcome overlay styles */
  #welcomeScreen {
    display: flex;
  }

  /* Game container styles */
  #gameContainer {
    display: none;
    position: relative;
    width: 600px;
    height: 600px;
    border: 4px solid #555;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
  }

  #score {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    color: #fff;
    font-size: 24px;
    padding: 8px 16px;
    background: rgba(0,0,0,0.5);
    border-radius: 8px;
    font-family: Arial, sans-serif;
    z-index: 1;
  }

  canvas {
    display: block;
    width: 100%;
    height: 100%;
  }

  /* Style for the small fixed music toggle button at bottom right */
  #musicToggle {
    position: fixed;
    bottom: 20px; /* moved from top to bottom */
    right: 20px; /* moved to bottom right corner */
    width: 60px;
    height: 30px;
    font-size: 0.8em;
    padding: 0;
    margin: 0;
    border: none;
    border-radius: 6px;
    background: linear-gradient(135deg, #00ffff, #007fff);
    color: #fff;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(0,255,255,0.7);
    z-index: 999; /* stay on top */
    transition: all 0.3s ease;
  }

  #musicToggle:hover {
    background: linear-gradient(135deg, #007fff, #00ffff);
    box-shadow: 0 0 15px rgba(0,255,255,1);
    transform: translateY(-2px);
  }
</style>
</head>
<body>

<!-- Background music and toggle button -->
<audio id="backgroundMusic" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" loop volume="0.2" style="display:none;"></audio>
<button id="musicToggle">Music</button>

<!-- Main menu -->
<div id="welcomeScreen">
  <div id="menu">
    <h1>Rafay's Snake Game</h1>
    <div style="margin-top:20px;">Select a Map:</div>
    <button class="map-button" data-speed="150" data-map="beginner">Beginner</button>
    <button class="map-button" data-speed="100" data-map="normal">Normal</button>
    <button class="map-button" data-speed="30" data-map="advanced">Advanced</button>
  </div>
</div>

<!-- Game container -->
<div id="gameContainer">
  <div id="score">Score: 0</div>
  <canvas id="gameCanvas" width="600" height="600"></canvas>
</div>

<script>
const welcomeScreen = document.getElementById('welcomeScreen');
const startButtons = document.querySelectorAll('.map-button');
const gameContainer = document.getElementById('gameContainer');
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreDiv = document.getElementById('score');
const music = document.getElementById('backgroundMusic');
const musicToggleBtn = document.getElementById('musicToggle');

let gameSpeed = 100; // default
let mapType = 'normal'; // default
let snake, direction, food, score, gameOver, gameInterval;

// Set background based on map type with snake patterns
function setBackground() {
  if (mapType === 'beginner') {
    document.body.style.background = 'linear-gradient(135deg, #FFD700, #FFFF00)';
    document.body.style.backgroundImage = `
      repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(0,0,0,0.05) 35px, rgba(0,0,0,0.05) 70px),
      repeating-linear-gradient(-45deg, transparent, transparent 35px, rgba(0,0,0,0.03) 35px, rgba(0,0,0,0.03) 70px)
    `;
  } else if (mapType === 'normal') {
    document.body.style.background = 'linear-gradient(135deg, #AA0114, #B40404)';
    document.body.style.backgroundImage = `
      repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(0,0,0,0.1) 35px, rgba(0,0,0,0.1) 70px),
      repeating-linear-gradient(-45deg, transparent, transparent 35px, rgba(0,0,0,0.08) 35px, rgba(0,0,0,0.08) 70px)
    `;
  } else if (mapType === 'advanced') {
    document.body.style.background = 'linear-gradient(135deg, #50C878, #008000)';
    document.body.style.backgroundImage = `
      repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(0,0,0,0.1) 35px, rgba(0,0,0,0.1) 70px),
      repeating-linear-gradient(-45deg, transparent, transparent 35px, rgba(0,0,0,0.08) 35px, rgba(0,0,0,0.08) 70px)
    `;
  }
}

// Start game when map is selected
startButtons.forEach(btn => {
  btn.onclick = () => {
    gameSpeed = parseInt(btn.getAttribute('data-speed'));
    mapType = btn.getAttribute('data-map');
    setBackground();
    welcomeScreen.style.display = 'none';
    gameContainer.style.display = 'block';
    startGame();
  };
});

// Toggle music on button click
let musicStarted = false;
musicToggleBtn.onclick = () => {
  if (!musicStarted) {
    music.volume = 0.2;
    music.play();
    musicStarted = true;
  } else {
    if (music.paused) {
      music.play();
    } else {
      music.pause();
    }
  }
};

// For browsers that block autoplay, user must click toggle to start music
window.onload = () => {
  // Wait for user interaction
};

document.addEventListener('keydown', changeDirection);

function spawnFood() {
  let newFood;
  do {
    newFood = {
      x: Math.floor(Math.random() * (canvas.width / 20)),
      y: Math.floor(Math.random() * (canvas.height / 20))
    };
  } while (
    snake.some(s => s.x === newFood.x && s.y === newFood.y)
  );
  return newFood;
}

function startGame() {
  snake = [{x: 10, y: 10}];
  direction = {x: 1, y: 0};
  food = spawnFood();
  score = 0;
  scoreDiv.innerText = 'Score: 0';
  gameOver = false;
  clearInterval(gameInterval);
  gameInterval = setInterval(update, gameSpeed);
}

function changeDirection(e) {
  const key = e.key;
  if (key === 'ArrowUp' && direction.y !== 1) {
    direction = {x: 0, y: -1};
  } else if (key === 'ArrowDown' && direction.y !== -1) {
    direction = {x: 0, y: 1};
  } else if (key === 'ArrowLeft' && direction.x !== 1) {
    direction = {x: -1, y: 0};
  } else if (key === 'ArrowRight' && direction.x !== -1) {
    direction = {x: 1, y: 0};
  }
}

function update() {
  if (gameOver) {
    alert('Game Over! Your score: ' + score);
    clearInterval(gameInterval);
    return;
  }

  const head = {x: snake[0].x + direction.x, y: snake[0].y + direction.y};
  const widthLimit = canvas.width / 20;
  const heightLimit = canvas.height / 20;

  if (head.x < 0 || head.x >= widthLimit || head.y < 0 || head.y >= heightLimit) {
    gameOver = true;
  }
  if (snake.some(s => s.x === head.x && s.y === head.y)) {
    gameOver = true;
  }

  if (gameOver) {
    alert('Game Over! Your score: ' + score);
    clearInterval(gameInterval);
    return;
  }

  snake.unshift(head);
  if (head.x === food.x && head.y === food.y) {
    score++;
    scoreDiv.innerText = 'Score: ' + score;
    food = spawnFood();
  } else {
    snake.pop();
  }

  draw();
}

function draw() {
  ctx.fillStyle = '#111';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  
  // Draw snake with realistic texture
  for (let i=0; i<snake.length; i++) {
    const s = snake[i];
    const x = s.x * 20;
    const y = s.y * 20;
    
    ctx.save();
    
    // Main body color - different for head
    if (i === 0) {
      // Head - brighter green with gradient
      const gradient = ctx.createRadialGradient(x + 10, y + 10, 2, x + 10, y + 10, 10);
      gradient.addColorStop(0, '#0f0');
      gradient.addColorStop(1, '#0a0');
      ctx.fillStyle = gradient;
    } else {
      // Body - darker green with gradient
      const gradient = ctx.createRadialGradient(x + 10, y + 10, 2, x + 10, y + 10, 10);
      gradient.addColorStop(0, '#0c0');
      gradient.addColorStop(1, '#060');
      ctx.fillStyle = gradient;
    }
    
    // Draw main body segment
    ctx.shadowColor = '#0f0';
    ctx.shadowBlur = 8;
    ctx.beginPath();
    ctx.roundRect(x + 1, y + 1, 18, 18, 5);
    ctx.fill();
    
    // Add scale pattern
    ctx.shadowBlur = 0;
    ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
    
    // Draw overlapping circles to create scale effect
    for (let row = 0; row < 2; row++) {
      for (let col = 0; col < 2; col++) {
        const offsetX = row % 2 === 0 ? 0 : 5;
        ctx.beginPath();
        ctx.arc(x + 5 + col * 10 + offsetX, y + 5 + row * 10, 4, 0, Math.PI * 2);
        ctx.fill();
      }
    }
    
    // Add highlights for 3D effect
    ctx.fillStyle = 'rgba(255, 255, 255, 0.15)';
    ctx.beginPath();
    ctx.arc(x + 7, y + 7, 3, 0, Math.PI * 2);
    ctx.fill();
    
    // If head, add eyes
    if (i === 0) {
      // Determine eye position based on direction
      let eyeX1 = x + 8, eyeY1 = y + 8;
      let eyeX2 = x + 12, eyeY2 = y + 8;
      
      if (direction.x === 1) { // Right
        eyeX1 = x + 14; eyeY1 = y + 7;
        eyeX2 = x + 14; eyeY2 = y + 13;
      } else if (direction.x === -1) { // Left
        eyeX1 = x + 6; eyeY1 = y + 7;
        eyeX2 = x + 6; eyeY2 = y + 13;
      } else if (direction.y === 1) { // Down
        eyeX1 = x + 7; eyeY1 = y + 14;
        eyeX2 = x + 13; eyeY2 = y + 14;
      } else if (direction.y === -1) { // Up
        eyeX1 = x + 7; eyeY1 = y + 6;
        eyeX2 = x + 13; eyeY2 = y + 6;
      }
      
      // Draw eyes
      ctx.fillStyle = '#fff';
      ctx.beginPath();
      ctx.arc(eyeX1, eyeY1, 2, 0, Math.PI * 2);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(eyeX2, eyeY2, 2, 0, Math.PI * 2);
      ctx.fill();
      
      // Draw pupils
      ctx.fillStyle = '#000';
      ctx.beginPath();
      ctx.arc(eyeX1, eyeY1, 1, 0, Math.PI * 2);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(eyeX2, eyeY2, 1, 0, Math.PI * 2);
      ctx.fill();
    }
    
    ctx.restore();
  }
  
  // Draw food as apple
  ctx.save();
  const fx = food.x * 20;
  const fy = food.y * 20;
  
  // Apple body
  const appleGradient = ctx.createRadialGradient(fx + 10, fy + 12, 3, fx + 10, fy + 12, 9);
  appleGradient.addColorStop(0, '#ff4444');
  appleGradient.addColorStop(1, '#cc0000');
  ctx.fillStyle = appleGradient;
  ctx.shadowColor = '#f00';
  ctx.shadowBlur = 10;
  ctx.beginPath();
  ctx.arc(fx + 10, fy + 12, 8, 0, Math.PI * 2);
  ctx.fill();
  
  // Apple highlight
  ctx.shadowBlur = 0;
  ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
  ctx.beginPath();
  ctx.arc(fx + 8, fy + 10, 3, 0, Math.PI * 2);
  ctx.fill();
  
  // Apple stem
  ctx.fillStyle = '#654321';
  ctx.fillRect(fx + 9, fy + 3, 2, 5);
  
  // Leaf
  ctx.fillStyle = '#0a0';
  ctx.beginPath();
  ctx.ellipse(fx + 13, fy + 5, 3, 2, Math.PI / 4, 0, Math.PI * 2);
  ctx.fill();
  
  ctx.restore();
}

// Polyfill
if (!CanvasRenderingContext2D.prototype.roundRect) {
  CanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) {
    if (w < 2 * r) r = w/2;
    if (h < 2 * r) r = h/2;
    this.beginPath();
    this.moveTo(x+r, y);
    this.arcTo(x+w, y, x+w, y+h, r);
    this.arcTo(x+w, y+h, x, y+h, r);
    this.arcTo(x, y+h, x, y, r);
    this.arcTo(x+w, y, x+w, y, r);
    this.closePath();
    return this;
  }
}
</script>
</body>
</html>
